Page 1: Introduction and Feedback Loop

So before I start talking about, uh, Gabor filters and what they are, um. Pointer seems to. Okay. Um. I want to say something about, uh, scientific jargon. So, uh, I been doing I've been doing computer science since I was 14. So I use a lot of terms that come with computer science and come with using, uh, programming. If you don't know a term, I just want you to raise your hand and be like, hey, I have no idea what you're talking about. What do you mean by this term? Because then you actually understand more of the lecture. And the goal of these lectures is that you should be able to understand the content that's in the slides throughout these two hours of the lecture, and then hopefully not have to sit at home and go over them again. So try to ask as much as possible during the lecture so you can at least get something out of it by being here, present in the in the room. Um, if you don't feel comfortable raising your hand and asking, uh, what a word means, you can also just, uh, send it via email. Just send me a list of. These are all the words you said during the last lecture, and I didn't know what they meant. And then I'll keep that in mind for for next time and try to explain those. Um, today we're going to talk about Gabor filters. And for that, uh, maybe already I'm going to ask you what is a filter? Gabor is a name. It's the person that created the filters. But does any of you know what what a filter is? Moves certain frequencies from a picture or. Yeah, but what is it? So this does what it does. Yeah. It's a matrix modification to an. Um, it's a matrix modification. Yeah. So, uh. Well. Yeah. So the values that are a in an image are altered by the matrix of numbers. Yeah. So a filter is a matrix of numbers if it's this correct. Um you typically use it in operations such as convolution or correlation. It's also synonymous with kernel. So if you use uh deep learning model then typically the filters in a deep learning layer are called kernels. Um, and today we're going to talk about a special type of filter. And that's this Gabor filter. But before I go into the, uh, the whole Gabor filter, uh, topic, I want to ask, um. One second. The pointer refuses to to cooperate. Come on. Should I click here? Huh? Okay. Now it wants to work again. Um, we had, uh, reading material for this lecture. Did any of you have time to to look over the reading material? Yeah. More or less. Okay. Um. So before I talk about, uh, uh, Gabor filters, we have to go a bit into a recap on, uh, Fourier transform because it builds on the concept of Fourier transform. So that's something you discussed about, I believe, uh, lecture ago. Um, what does a Fourier transform do intuitively? Any thoughts? Like what? What do we do with the Fourier transform? Yes, it will change the frequencies. We transform signals into frequencies. Or any other thoughts more precisely. We decompose the signal into its component frequencies. Indeed. That's that's, uh. Correct. Yeah.

Page 2: Fourier Transform Intuition and 2D Images

You can also go the other way around so it can signal other things. You can also do it the other way around. That's true. Yeah. You can create, for example, a song or something out of combining different frequencies. That's true. Um. And how do you do that? Precisely. Like, what do you do to to apply Fourier transform to a signal? No, no. Clear, clear idea on how we do that. Let's see if, um. If we get a more clear idea. Um, so what Fourier transform does is. Imagine this is your, your time domain. So now we're talking about 1D signal. We're going to talk about images later on. Um this is your time domain. And you have this blocky signal. And what you want to do is indeed you want to find what are the frequencies that create the signal. And you do that by approximating the signal with a linear combination of sinusoids. So these are sinusoids in, in, uh, blue and in green and in red and in orange. And they all have different frequencies. And then you say how much of, of the green wave do I have to put into the signal? How much of the red wave do I have to put to be able to create back the signal that I started with? So that's what Fourier transform intuitively does. It's it's creates this combination of sinusoids that approximates the the signal and typically Fourier transform, of course. Uh, it's the continuous Fourier transform goes up to an infinity of this, this sinusoids. But in practice when we work with computers we use discrete Fourier transform. So then it's an approximation of a signal as good as possible. Um. So. As I said in in the previous slide, what we do is we decompose the input signal into, uh, sinusoids and we do the same thing with images. So that was for 1D signal. And this is for, uh, an image. And then for an image. The Fourier transform is a two dimensional transform, not a one dimensional transform. So for example, if I have a purely greyscale image. The Fourier transform of it will just be, uh, the zero zero component. It will be the average of the image, pretty much. Um, if you have an image that contains one sinusoid that varies along the x axis, um, then you're going to have two points around the centre. So this is the zero zero component in the Fourier transform. And this is a certain frequency. And then the mirrored one because Fourier transform is um symmetric domain. So it is symmetric uh around zero zero. So that's why you have the mirrored uh version of this frequency. That's the frequency of this sinusoid. The same thing if you have a, uh, sinusoid that goes along the, uh, vertical direction along the Y direction, then you have two frequencies along the, uh, the vertical direction. It's actually the mirrored the actual frequency in the mirrored version of it. And then if you have a blocky pattern, then you would get, uh, a little, uh, cross, uh, of, of dots from the two combined frequencies and they're mirrored versions. What is the distance between these points? How far they are? Do you have an idea why? Why are these three points further away than this? Three points here, for example. Yeah. Yeah, exactly. So this is the zero zero frequency. This has a low frequency. A low frequency means it changes slowly. A high frequency means it changes very fast. This has a higher frequency. It changes a lot faster from black to dark, uh, from black to white and back. So then it's further away from the zero zero component.

Page 3: The Math and Euler's Formula

And now a bit of smart. Don't get scared about it. I'm going to try to explain to you the actual formula. So when you apply the the Fourier transform, you're actually moving into a different coordinate system. So you're initially in the x y coordinate system. You're in the image coordinate system typically images when you're in codomain computers you have the zero zero uh coordinate the the top left corner. And you have the an m in this case n minus one m minus one. Because we start counting from zero at the bottom right corner. And then when we move to the Fourier domain, all of a sum of the zero zero is here. And we also don't call it x and y anymore. We call it u and v to avoid a confusion, because then the coordinates of the Fourier transform of the Fourier domain are not pixel coordinates anymore. They are frequencies. So every point in the Fourier domain represents a certain frequency. Um, and if you look at the, the formula here, uh, you have the Fourier transform at the certain u, v the frequency combinations. So like column row. So a certain point here in the, in the Fourier domain, uh, it's actually a sum over x and y's in the image domain. So you're actually going over the complete image. You're going over all the pixels in your image. And then you're doing this weighted combination of your images and those pixels with this e to the power I minus uh two pi something something. Um, and that's the Fourier transform. And what's this thingy here in green? Does this anyone know what this is to the power minus two pi stuff is. Yeah. So the real application. Yeah, yeah. So if you remember the sampling lecture there, we talked a bit about Euler uh formula. And this is actually the equivalent uh it's the Euler's equivalent of sines and cosines. So it's this is an imaginary plus uh a real part. And then we can actually see it, um, written in uh, the equation. So indeed it's a complex number. So that's also something to note about. Fourier transform actually gives you back complex numbers. It gives you a number at every, uh, location in the frequency domain on the grid with the real and an imaginary part. And then if you remember this, this slide from the, uh, the sampling lecture there, we talked about. Well, if I have a complex numbers that equals a plus B I. Then Euler's formula says that I can also write the same number as cos plus i sin theta. So that's that's how to to to realise why. Why does uh. Fourier transform become a combination of of sines and cosines. And why do I say well, when we I want to approximate the signal, we're actually, uh, um, creating these linear combinations of sines and cosines. It actually comes from the actual formulation of, of how Fourier transform is defined, is defined us as this e to the power minus two pi here. And that's actually sine plus cosine. So that's that's why we're approximating a signal with sinusoids. So we have the we have the, uh, complex numbers. Um, and we saw that this can be written with Euler's formula into um. Sines and cosines. So that means we can also write the Fourier transform like this. We can also write it as cos of this thingy here minus I sin sine of this thingy here. This the same formulation. It's equivalent.

Page 4: Visualizing Domain and Magnitude vs. Phase

Um, and now I'm going to go a bit and try to build a bit of intuition of what Fourier does over images. So, for example, here, uh, we're in the Fourier domain. So this is the, the u axis. And this is the v axis. And then you have sinusoids across the, the, the, in the U direction and in the V direction. Um, and these are all complex numbers. So that means they have a real part and an imaginary part. So at every point in the Fourier domain you have a complex number. So f of u and v is actually a complex number which means it has a cos in a sine. And the cos in the sign correspond to a sinusoid with a certain frequency, and the frequency is given by u and v. So it's the frequency on the x direction. Here you don't have any frequency in the y direction is constant. Here you have only frequency in the y direction. And you have no frequency in the x direction. And you have both frequencies in the x direction in the y direction. And that's how to understand the Fourier domain on images. Are there any words I've said so far or things I've mentioned that that's or confusing or. You are not familiar with. Okay. Then I'm going to ask you to. Okay. There was another thing I wanted to mention. People typically refer to this. This. This thing is here as sinusoids. And you're going to be like, yeah, but it's of course in sound. Why do we call them sinusoids? Well, that's because actually you can convert a cos into a sine there. This there's a correspondence formula. So you could just say okay. It's all sines. In my perspective it's just a two pi shift uh, in the angle. So who cares? I can just say it's just a combination of shifted sines. Um, so I'm going to do a little quiz to see how much of, of of this, uh, Fourier stuff uh, we got or how much intuition we have about the Fourier domain. So I'd like you to match the images here with the their Fourier correspondence. Uh, uh, below. So let's start with image one. Which one of the the Fourier components do you think it belongs to that? Uh, image one. And I thought it's. C. Okay. Um. That's correct. But I shouldn't say that because now you have less options to guess. Wrong. Uh, in which, uh, two. What would it be? Any other thoughts? Somebody else wants to guess. What would be the corresponding, uh, image? Maybe because it seems more complex. It seems more complex. Um. Yeah, yeah. And then of course, then we have image three that then is left over with, with uh Fourier. So you can expect these kind of questions in the exam. Just, just a heads up. It's something that, that you have to get a bit, uh, accustomed to. How do you interpret the, uh, correspondence between an image and its Fourier component? And indeed, what you can see here is that there's a lot of, uh, frequencies along this direction. And that's what you see here also. Right? So you have a lot of sinusoids with different frequencies, but they are all under the same orientation. So that's that's what gives up. So I would have guessed this one first. And then this one is similar to this one. But then it goes in two directions. Right. Because you have the bricks that go have edges in both directions. And then this one is a bit of a combination of a whole bunch of directions. So you have like variations in the image that goes across multiple, uh, sinusoid directions.

Page 5: Calculating Magnitude, Phase, and Localization

Um, and I believe in the, uh, in the Friday lecture, you also talked about magnitude and phase of, uh, Fourier transform. Uh, what does the magnitude of the Fourier transform encode? So what? What does it mean? The weights we assigned to each side? Yeah, yeah. Actually, it's just very good. So it's indeed it's how much each sinusoid contributes to create back the the, uh, original signal. So how important is this specific sinusoid in in creating in approximating the signal that we want to approximate. Because in the end, with discrete Fourier transform, we want to approximate, um, a signal with a combination of sinusoids. Um, yes. So that's how much each sinusoid contributes to create the whole image and the phase. What does the phase, uh, encode? This is a bit more difficult, I have to say. I myself find it very difficult to get a bit of intuition about the phase, so it's, uh, it's hard to visualise it in your in your heads mind because with, with magnitude it's clearer. Okay. It's, it's how important this sinusoid is. But with phase like what's what's phase. Any thoughts? What does the phase do? You could. There are no wrong answers, guys. So, like, you can just say whatever crosses your mind and then we're going to think about it. Yeah. Uh, I mean, the phase, uh, is responsible for shifting, uh, sincerely. So maybe it's responsible for shifting. Also where the data is on the original image. Um, I think I think you're very close to to getting an indication of of what exactly the phase does or indeed, I believe this is the picture you also saw in in the lecture. Of course, I just added colours to it, but the phase is indeed a shift into where the sinusoid starts. Um, and what you have to think about is when you approximate an image as a combination of sinusoids... you may want different of the sinusoids to start at a different point along the side. Because then when you add them together, then you can create different variations in your pattern. And it's the same thing with images. You shift them. So they start with the different point and then the 0,0. Then you actually can generate different factors in your approximation. So how do we compute the magnitudes or also called the amplitude of the Fourier uh, transform? Do you guys know how to compute the magnitude of a complex number? Yeah. How do you do that? The square root of the real part squared, plus the imaginary parts. Precisely. That's exactly it. And that's exactly how we compute the the, uh, magnitude of the Fourier transform. So it's, it's the, the absolute value of this, uh, complex number, which is like the real part squared plus the imaginary squared and the square root of it. Uh, how about the phase? Does anyone have any idea how you would compute the phase of the Fourier transform? We're going to try to compute the angle of the Fourier transform. Um and that is. The arctangent of the imaginary part divided by the real part. Some of the Fourier values. And that gives me the phase. And the phase looks like this. It's it's not very informative. It's it's hard to to figure out what's in there. It's pretty much says at every frequency in this Fourier domain, at every UV frequencies: How much do I have to shift this sine such, uh, that I can reconstruct the, uh, original signal.

Page 6: Gabor Filters and Wavelets

Looking at the Fourier transform. Can we say something about the frequencies present, for example, here in it? Let's say I'm really curious about... I really want to know what are the frequencies present in the sky area of, of this image. Could I find him back here? Yeah. I don't think there's a lot. Why not? Indeed. There's not much information about where these pixels are here. Because it's not, uh, proposition. All the pixels in the image contribute to a single point in the Fourier domain. So therefore I cannot say where are the pixels, for example, here in the background. Where do they fall in in this area. Because they contributed to every single bin here. Because of that, because it's it's averaged over all the x y points, we actually say the Fourier transform is a global transformation. It's not a local transformation. It doesn't tell us something about the specific pixel. Um, do you guys know a local transformation? Image filtering. Exactly. Convolution. That is a local transformation. Can anyone explain to me why? Because if I take this filter or kernel, I apply it over every pixel in the image. So for every pixel in the input image you have a value in the output image. So that is a local transformation because then it says something about that specific pixel. How that specific pixel together with its neighbouring pixels do something. Typically when we work with images, we want to say something about the regions in the images. We want to say something about what's the local information, not only the global information. And that's what the Gabor filters do. The Gabor filters allow us to, uh, look at the frequencies present in specific parts of the image. So it's sort of a localised version of the, uh, Fourier transform. And for that, I'm going to just shortly introduce the idea of, uh, a wavelet. So wavelet actually means a short wave. And Gabor filters are wavelets, so they are short waves. And here's a sine wave. Um, and a wavelet is a short version of this. So it's a version that it's all only has values in a, in a limited window. And for the rest it doesn't exist. Gabor filters give us localised frequencies. They are a sine wave and now imagine that I just take uh, a cut through the, the image. And here red means uh, minus one and then blue means plus one. And then I put a Gaussian hat so Gaussian kernel on top of this sine wave. And then what happens with the Gaussian. It has the zero values here outside of the hat and only values underneath this hat. And now if I multiply this with each other. I get a wavelet. I get a squashed sine wave that has values only underneath the Gaussian hat. This is an example of a Gabor wavelet. And then I can use this to convolve the image with just as you learned in the convolution lecture. And that will tell me how much of this sine frequency is a different location in the image. Next to giving us localised frequencies, the, the Gabor wavelets also give us localised orientations. So I can take this, this sine wave now and I can rotate it with different angles. Does anyone have an idea of...
